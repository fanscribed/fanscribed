{% extends "base.html" %}


{% block nav_class_transcribe %}
  active
{% endblock %}


{% block content %}

  <h1><a href="{% url 'transcripts:detail' pk=transcript.pk %}">{{ transcript.name }}</a></h1>

  {% if user.is_authenticated %}

    {% url 'transcripts:task_assign' pk=transcript.pk as task_assign_url %}

    <form action="{{ task_assign_url }}" method="post">
      {% csrf_token %}
      <button class="btn btn-primary" type="submit" name="type" value="any">
        Any Task
      </button>
      <div class="btn-group">
        <button class="btn btn-default" type="submit" name="type" value="transcribe">
          Transcribe
        </button>
        <button class="btn btn-default" type="submit" name="type" value="transcribe_review">
          Review Transcription
        </button>
      </div>
      <div class="btn-group">
        <button class="btn btn-default" type="submit" name="type" value="stitch">
          Stitch
        </button>
        <button class="btn btn-default" type="submit" name="type" value="stitch_review">
          Review Stitch
        </button>
      </div>
      <div class="btn-group">
        <button class="btn btn-disabled" disabled type="submit" name="type" value="boundary">
          Identify Boundary
        </button>
        <button class="btn btn-disabled" disabled type="submit" name="type" value="boundary_review">
          Review Boundary
        </button>
      </div>
      <div class="btn-group">
        <button class="btn btn-disabled" disabled type="submit" name="type" value="speaker">
          Identify Speaker
        </button>
        <button class="btn btn-disabled" disabled type="submit" name="type" value="speaker_review">
          Review Speaker
        </button>
      </div>
    </form>

  {% else %}

    {% url 'transcripts:detail' pk=transcript.pk as detail_url %}

    <a class="btn btn-primary"
       href="{% url 'account_login' %}?next={{ detail_url }}">
      Sign In
    </a>

  {% endif %}

  <h2>Tasks</h2>

  <div class="row">

    <div class="col-md-3">
      <h3>Transcribe</h3>
      {% include 'transcripts/_transcript_task_stats_dl.html' with tasks=transcript.transcribetask_set %}
    </div>

    <div class="col-md-3">
      <h3>Stitch</h3>
      {% include 'transcripts/_transcript_task_stats_dl.html' with tasks=transcript.stitchtask_set %}
    </div>

  </div>

  <h2>Fragments</h2>

  <dl class="dl-horizontal">

    {# TODO: turn these into little bar charts #}

    <dt>Total</dt>
    <dd>{{ transcript.fragments.count }}</dd>

    <dt>Empty</dt>
    <dd>{{ transcript.fragments.empty.count }}</dd>

    <dt>Transcribed</dt>
    <dd>{{ transcript.fragments.transcribed.count }}</dd>

    <dt>Transcript Reviewed</dt>
    <dd>{{ transcript.fragments.transcript_reviewed.count }}</dd>

    <dt>Stitched</dt>
    <dd>{{ transcript.fragments.stitched.count }}</dd>

    <dt>Stitch Reviewed</dt>
    <dd>{{ transcript.fragments.stitch_reviewed.count }}</dd>

    <dt>Locked</dt>
    <dd>{{ transcript.fragments.locked.count }}</dd>

    <dt>Unlocked</dt>
    <dd>{{ transcript.fragments.unlocked.count }}</dd>

  </dl>
  
{% endblock %}
