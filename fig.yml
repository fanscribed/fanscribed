db:
  image: postgres:9.3

redis:
  image: dockerfile/redis

# Allows tools like PyCharm to SSH in and introspect the environment.
sshd:
  build: backend/
  command: scripts/sshd.sh
  ports:
    - "14220:22"
  volumes:
    - backend:/usr/src/app

web:
  build: backend/
  command: python manage.py runserver_plus 0.0.0.0:8000
  links:
    - db
    - redis
  ports:
    - "8000:8000"
  volumes:
    - backend:/usr/src/app

worker:
  build: backend/
  command: python manage.py celery worker -l INFO --autoreload
  links:
    - db
    - redis
  volumes:
    - backend:/usr/src/app

frontend:
  build: frontend/
  command: serve 0.0.0.0:4200
  entrypoint: /usr/src/app/scripts/ember-watchdog.sh
  ports:
    - "4200:4200"
  volumes:
    - frontend:/usr/src/app.host
